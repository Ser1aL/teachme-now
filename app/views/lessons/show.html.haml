- if @lesson.course
  .course_lesson_panel
    .left
      %span.label
        = t "lesson.is_part_of_course"
      %span.course_name
        = link_to @lesson.course.name, course_path(@lesson.course), class: 'blue_link'
    .right
      %span= link_to t("lesson.go_to_course"), course_path(@lesson.course), class: 'blue_link'
    .delimiter
.single_lesson_wrapper
  .lesson
    .title= @lesson.name
    .delim
    .body
      .hint.left_hint= t "course.hint.description"
      .hint.right_hint
        = t("lesson_form.start_date_time") + ":"
        %span.start_datetime= @lesson.start_datetime
      .delimiter
      .left= @lesson.description.html_safe
      .right
        - if @lesson.teachers.include?(current_user)
          .buy_pass.disabled
            %a{ href: edit_lesson_path(@lesson) }
              %span
                = t('lesson.edit_lesson')
        - elsif @lesson.user_already_applied?(current_user)
          .buy_pass.disabled
            %a.disabled
              %span
                = t('lesson.already_applied')
        - elsif !@lesson.available?
          .buy_pass.disabled
            %a.disabled
              %span
                = t('lesson.no_place')
        - elsif @lesson.passed?
          .buy_pass.disabled
            %a.disabled
              %span
                = t('lesson.already_passed')
        - else
          .buy_pass
            %a{ href: get_buy_passes_path(@lesson) }
              %span
                %b
                  = @lesson.place_price
                = t "currency"
        .delimiter
        .vk_share{ data: { lesson_name: @lesson.name, button_text: t("vk_share_button.button_text"), common_title: t("vk_share_button.post_title") } }
      .delimiter
    .body
      .hint.left_hint= t "course.hint.tease_description"
      .delimiter
      .left= @lesson.tease_description.html_safe
      .right
      .delimiter
      .bot
        .text_block
          = t('lesson.teacher') + ':'
          = link_to @lesson.teachers.first.full_name, user_path(@lesson.teachers.first), class: 'blue_link'
        .lesson_delimiter
        .text_block
          = t('lesson.rating') + ':'
          %b= @lesson.teachers.first.ratings.sum(&:rating)
        .lesson_delimiter
        .text_block
          = t('lesson.city') + ':'
          = t "lesson.cities.#{@lesson.city}"
        .lesson_delimiter
        .text_block
          = t('lesson.level') + ':'
          = t "lesson.lesson_level.#{@lesson.level}"
        .lesson_delimiter
        .text_block
          = t('lesson.capacity') + ':'
          = @lesson.capacity
        .lesson_delimiter
        .text_block
          = t('lesson.places_taken') + ':'
          %span.places_count
            = @lesson.places_taken
        .lesson_delimiter
        .text_block
          = t "interests.#{@lesson.interest.name}"
        .lesson_delimiter
        .text_block
          = t "sub_interests.#{@lesson.sub_interest.name}"
        .delimiter